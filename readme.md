Just the refactoring branch. Bit of a mess right now, but it's being worked out! 
